<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width" />
    <meta name="server-version" th:content="${serverVersion}"/>
    <!--
    *
    * (c) Copyright Ascensio System SIA 2024
    *
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    *     http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    *
    -->
    <title>ONLYOFFICE在线文档协调编辑平台</title>
    <link rel="icon" type="image/ico" href="/favicon.ico"/>
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Open+Sans:900,800,700,600,500,400,300&subset=latin,cyrillic-ext,cyrillic,latin-ext" />
    <link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
    <link rel="stylesheet" type="text/css" href="css/jquery-ui.css" />
    <link rel="stylesheet" type="text/css"  href="css/media.css">
</head>
<body>
    <header>
        <div class="center">
            <a href="">
                <img src ="css/img/logo.svg" alt="ONLYOFFICE" />
            </a>
        </div>
    </header>

    <div class="center main">
        <table class="table-main">
            <tbody>
            <tr>
                <td class="left-panel section">
                    <div class="help-block">
                        <span>新建文档</span>
                        <div class="clearFix">
                            <div class="create-panel clearFix">
                                <ul class="try-editor-list clearFix">
                                    <li>
                                        <a class="try-editor word" data-type="docx">Word</a>
                                    </li>
                                    <li>
                                        <a class="try-editor cell" data-type="xlsx">Excel</a>
                                    </li>
                                    <li>
                                        <a class="try-editor slide" data-type="pptx">PowerPoint</a>
                                    </li>
                                </ul>
                            </div>

                            <form method="POST" action="/upload" enctype="multipart/form-data" class="upload-panel clearFix">
                                <a class="file-upload">上传文档
                                    <input type="file" id="fileupload" name="file" />
                                </a>
                            </form>

                            <table class="user-block-table" cellspacing="0" cellpadding="0">
                                <tbody>
                                    <tr>
                                        <td valign="middle">
                                            <span class="select-user">当前用户：</span>
                                            <span class="select-user" th:text="${username}"></span>
                                            <br>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td valign="middle">
                                            <span class="select-user">使用提示：</span>
                                            <br>
                                            <span class="select-user">1. 文件重命名方法：
                                                打开文档，点击“文件”、“重命名”，之后点击“另存为”。</span>
                                            <br>
                                            <span class="select-user">2. 目前文档编辑页面不支持与Keycloak对接，
                                                如有需要需要点击右上角手动录入自己姓名。</span>
                                            <br>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </td>
                <td class="section">
                    <div class="main-panel">
                        <th:block th:if="${not #lists.isEmpty(files)}">
                            <div class="stored-list">
                                <span class="header-list">已有的文档</span>
                                <div class="scroll-table-body">
                                    <table cellspacing="0" cellpadding="0" width="100%">
                                        <tbody>
                                        <tr th:each="file,iState : ${files}" class="tableRow" th:title="${files[iState.index].getName() + versions[iState.index]}">
                                            <td class="contentCells contentCells-filename">
                                                <a class="stored-edit" th:classappend="${docTypes[iState.index]}"
                                                   th:with="directUrl=${directUrl}"
                                                   th:href="@{/editor(fileName=${files[iState.index].getName()}, __(${#strings.isEmpty(directUrl)} ? '' : ('directUrl=' + ${directUrl}))__)}" target="_blank">
                                                <span th:text="${files[iState.index].getName()}"></span>
                                                </a>
                                            </td>
                                            <td class="contentCells contentCells-download">
                                                <a th:href="@{/download(fileName=${files[iState.index].getName()})}" target="_blank">
                                                <img class="icon-download" src="css/img/download.svg" alt="下载" title="下载" />
                                                </a>
                                            </td>
                                            <td class="contentCells contentCells-remove">
                                                <a class="delete-file" th:attr="data-filename=${files[iState.index].getName()}">
                                                    <img class="icon-delete" src="css/img/delete.svg" alt="删除" title="删除" />
                                                </a>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </th:block>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <div id="mainProgress">
        <div id="uploadSteps">
            <span id="uploadFileName" class="uploadFileName"></span>
            <div class="describeUpload">After these steps are completed, you can work with your document.</div>
            <span id="step1" class="step">1. Loading the file.</span>
            <span class="step-descr">The loading speed depends on file size and additional elements it contains.</span>
            <br />
            <span id="step2" class="step">2. Conversion.</span>
            <span class="step-descr">The file is converted to OOXML so that you can edit it.</span>
            <br />
            <div id="blockPassword">
                <span class="descrFilePass">The file is password protected.</span>
                <br />
                <div>
                    <input id="filePass" type="password"/>
                    <div id="enterPass" class="button orange">Enter</div>
                    <div id="skipPass" class="button gray">Skip</div>
                </div>
                <span class="errorPass"></span>
                <br />
            </div>
            <span id="step3" class="step">3. Loading editor scripts.</span>
            <span class="step-descr">They are loaded only once, they will be cached on your computer.</span>
            <input type="hidden" name="hiddenFileName" id="hiddenFileName" />
            <br />
            <span class="progress-descr">Note the speed of all operations depends on your connection quality and server location.</span>
            <br />
            <div class="error-message">
                <b>Upload error: </b><span></span>
                <br />
                Please select another file and try again.
            </div>
        </div>
        <iframe id="embeddedView" src="" height="345px" width="432px" frameborder="0" scrolling="no" allowtransparency></iframe>
        <br />
        <div class="buttonsMobile">
            <div id="beginEdit" class="button orange disable">Edit</div>
            <div id="beginView" class="button gray disable">View</div>
            <div id="beginEmbedded" class="button gray disable">Embedded view</div>
            <div id="cancelEdit" class="button gray">Cancel</div>
        </div>
    </div>

    <span id="loadScripts" th:attr="data-docs=${datadocs}"></span>

    <footer>
        <div class="center">
            <table>
                <tbody>
                <tr>
                    <td>
                        版本：v20240529 内测版 by Xiping Hu &lt;hxp@hxp.plus&gt;
                    </td>
                    <td class="copy">
                        本项目基于 Ascensio Systems SIA 的开源项目
                        <a href="https://www.onlyoffice.com/" target="_blank">ONLYOFFICE</a> 开发
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </footer>

    <script type="text/javascript" src="scripts/jquery-3.6.4.min.js"></script>
    <script type="text/javascript" src="scripts/jquery-migrate-3.4.1.min.js"></script>
    <script type="text/javascript" src="scripts/jquery-ui.js"></script>
    <script type="text/javascript" src="scripts/jquery.blockUI.js"></script>
    <script type="text/javascript" src="scripts/jquery.iframe-transport.js"></script>
    <script type="text/javascript" src="scripts/jquery.fileupload.js"></script>
    <script type="text/javascript" src="scripts/jquery.dropdownToggle.js"></script>
    <script type="text/javascript" src="scripts/jscript.js"></script>
    <script type="text/javascript" src="scripts/converter.js"></script>
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById("language").value="zh";
        });
    </script>
</body>
</html>